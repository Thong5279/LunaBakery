<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36" version="27.1.1">
  <diagram id="cdm_luna_bakery_mongodb_extended_en" name="Luna Bakery CDM (MongoDB Extended - EN)">
    <mxGraphModel dx="2972" dy="1105" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="users_Collection" value="&lt;b&gt;users&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;username: String &lt;i&gt;(unique, required)&lt;/i&gt;&lt;br&gt;passwordHash: String &lt;i&gt;(required)&lt;/i&gt;&lt;br&gt;email: String &lt;i&gt;(unique, optional)&lt;/i&gt;&lt;br&gt;phoneNumber: String &lt;i&gt;(optional)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#FF00FF&quot;&gt;address&lt;/font&gt;: &lt;font color=&quot;#FF00FF&quot;&gt;{street, city, zipCode, country, lat, long}&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;createdAt&lt;/font&gt;: &lt;font color=&quot;#FF8000&gt;Date&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;lastLogin&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#800080&quot;&gt;roles&lt;/font&gt;: &lt;font color=&quot;#800080&gt;[String] &lt;i&gt;(&quot;customer&quot;, &quot;admin&quot;, &quot;manager&quot;, &quot;baker&quot;, &quot;delivery_staff&quot;)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF00FF&quot;&gt;customerInfo&lt;/font&gt;: &lt;font color=&quot;#FF00FF&gt;{fullName, loyaltyPoints, dateOfBirth, preferredContactMethod}&lt;/font&gt;&lt;br&gt;isActive: Boolean&lt;br&gt;profilePictureUrl: String&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=#D6B656;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="50" width="300" height="320" as="geometry" />
        </mxCell>
        <mxCell id="products_Collection" value="&lt;b&gt;products&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;name: String &lt;i&gt;(unique, required)&lt;/i&gt;&lt;br&gt;description: String&lt;br&gt;price: Double &lt;i&gt;(required)&lt;/i&gt;&lt;br&gt;stockQuantity: Integer &lt;i&gt;(required)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#800080&quot;&gt;imageUrl&lt;/font&gt;: &lt;font color=&quot;#800080&gt;[String]&lt;/font&gt;&lt;br&gt;status: String &lt;i&gt;(&quot;in_stock&quot;, &quot;out_of_stock&quot; etc.)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;categoryId&lt;/font&gt;: &lt;font color=&quot;#008000&gt;ObjectID &lt;i&gt;(ref: product_categories)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#800080&quot;&gt;tags&lt;/font&gt;: &lt;font color=&quot;#800080&gt;[String]&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;createdAt&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;lastUpdated&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date&lt;/font&gt;&lt;br&gt;averageRating: Double &lt;i&gt;(denormalized)&lt;/i&gt;&lt;br&gt;totalReviews: Integer &lt;i&gt;(denormalized)&lt;/i&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="450" y="50" width="300" height="300" as="geometry" />
        </mxCell>
        <mxCell id="product_categories_Collection" value="&lt;b&gt;product_categories&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;name: String &lt;i&gt;(unique, required)&lt;/i&gt;&lt;br&gt;description: String&lt;br&gt;productCount: Integer &lt;i&gt;(denormalized)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;parentId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(self-ref for subcategories)&lt;/i&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="800" y="50" width="250" height="150" as="geometry" />
        </mxCell>
        <mxCell id="orders_Collection" value="&lt;b&gt;orders&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;customerId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: users, required)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;orderDate&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date &lt;i&gt;(required)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;totalAmount: Double &lt;i&gt;(required)&lt;/i&gt;&lt;br&gt;orderStatus: String &lt;i&gt;(&quot;pending&quot;, &quot;delivered&quot; etc.)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#FF00FF&quot;&gt;shippingAddress&lt;/font&gt;: &lt;font color=&quot;#FF00FF&gt;{street, city, zipCode, recipientName, recipientPhone}&lt;/font&gt;&lt;br&gt;notes: String&lt;br&gt;&lt;font color=&quot;#800080&quot;&gt;orderDetails&lt;/font&gt;: &lt;font color=&quot;#800080&gt;[{productId, productName, quantity, unitPrice, subtotal, imageUrl}]&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;promoId&lt;/font&gt;: &lt;font color=&quot;#008000&gt;ObjectID &lt;i&gt;(ref: promotions, optional)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;voucherCodeUsed&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;String &lt;i&gt;(ref: vouchers, optional)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;paymentTransactionId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: payment_transactions, required)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;deliveryStaffId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: users, optional)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;expectedDeliveryDate&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date &lt;i&gt;(optional)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;actualDeliveryDate&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date &lt;i&gt;(optional)&lt;/i&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DAE8FC;strokeColor=#6C8EBF;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="-530" y="470" width="350" height="400" as="geometry" />
        </mxCell>
        <mxCell id="promotions_Collection" value="&lt;b&gt;promotions&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;promoCode: String &lt;i&gt;(unique, optional)&lt;/i&gt;&lt;br&gt;name: String&lt;br&gt;description: String&lt;br&gt;discountValue: Double&lt;br&gt;discountType: String &lt;i&gt;(&quot;percentage&quot;, &quot;fixed_amount&quot;, &quot;free_shipping&quot;)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;startDate&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date &lt;i&gt;(required)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;endDate&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date &lt;i&gt;(required)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;conditions: String &lt;i&gt;(&quot;min_order:50k&quot;, &quot;new_customers&quot;)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#800080&quot;&gt;applicableProducts&lt;/font&gt;: &lt;font color=&quot;#800080&quot;&gt;[ObjectID] &lt;i&gt;(ref: products, optional)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;isActive: Boolean&lt;br&gt;usageLimit: Integer &lt;i&gt;(total uses)&lt;/i&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DAE8FC;strokeColor=#6C8EBF;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="450" y="380" width="300" height="270" as="geometry" />
        </mxCell>
        <mxCell id="ingredients_Collection" value="&lt;b&gt;ingredients&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;name: String &lt;i&gt;(unique, required)&lt;/i&gt;&lt;br&gt;unitOfMeasure: String &lt;i&gt;(&quot;gram&quot;, &quot;ml&quot;, &quot;unit&quot;, &quot;kg&quot;)&lt;/i&gt;&lt;br&gt;stockQuantity: Double&lt;br&gt;minStockLevel: Double&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;lastRestockedDate&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;expiryDate&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date &lt;i&gt;(optional)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;supplierInfo: String&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;lastUpdated&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="800" y="230" width="280" height="220" as="geometry" />
        </mxCell>
        <mxCell id="recipes_Collection" value="&lt;b&gt;recipes&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;name: String &lt;i&gt;(unique, required)&lt;/i&gt;&lt;br&gt;description: String&lt;br&gt;prepTimeMinutes: Integer&lt;br&gt;instructions: String&lt;br&gt;&lt;font color=&quot;#800080&quot;&gt;requiredIngredients&lt;/font&gt;: &lt;font color=&quot;#800080&gt;[{ingredientId, quantity, unitOfMeasure}]&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;bakerId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: users, optional)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;servings: String&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="800" y="480" width="280" height="210" as="geometry" />
        </mxCell>
        <mxCell id="vouchers_Collection" value="&lt;b&gt;vouchers&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;voucherCode: String &lt;i&gt;(unique, required)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;promotionId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: promotions, required)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;userId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: users, optional - if user-specific)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;isUsed: Boolean &lt;i&gt;(default: false)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;usedDate&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date &lt;i&gt;(optional)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;orderId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: orders, optional - if used)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;isActive: Boolean&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8CECC;strokeColor=#B85450;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="450" y="700" width="280" height="200" as="geometry" />
        </mxCell>
        <mxCell id="payment_transactions_Collection" value="&lt;b&gt;payment_transactions&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;orderId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: orders, required)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;externalTransactionId: String &lt;i&gt;(from payment gateway, unique)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;transactionDate&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date &lt;i&gt;(required)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;amount: Double &lt;i&gt;(required)&lt;/i&gt;&lt;br&gt;paymentMethod: String &lt;i&gt;(&quot;credit_card&quot;, &quot;cash&quot;, &quot;bank_transfer&quot;)&lt;/i&gt;&lt;br&gt;paymentStatus: String &lt;i&gt;(&quot;completed&quot;, &quot;pending&quot;, &quot;failed&quot;, &quot;refunded&quot;)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#FF00FF&quot;&gt;gatewayResponse&lt;/font&gt;: &lt;font color=&quot;#FF00FF&quot;&gt;{...} &lt;i&gt;(raw gateway response)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;currency: String &lt;i&gt;(e.g., &quot;VND&quot;, &quot;USD&quot;)&lt;/i&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DAE8FC;strokeColor=#6C8EBF;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="-110" y="960" width="300" height="230" as="geometry" />
        </mxCell>
        <mxCell id="wishlists_Collection" value="&lt;b&gt;wishlists&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;userId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: users, unique, required)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#800080&quot;&gt;products&lt;/font&gt;: &lt;font color=&quot;#800080&gt;[{productId, addedDate, notes}] &lt;i&gt;(ref: products)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;createdAt&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;lastUpdated&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DAE8FC;strokeColor=#6C8EBF;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="340" y="970" width="280" height="150" as="geometry" />
        </mxCell>
        <mxCell id="product_reviews_Collection" value="&lt;b&gt;product_reviews&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;productId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: products, required)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;userId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: users, required)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;rating: Integer &lt;i&gt;(1-5)&lt;/i&gt;&lt;br&gt;comment: String&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;reviewDate&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date&lt;/font&gt;&lt;br&gt;isApproved: Boolean &lt;i&gt;(for moderation)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#800080&quot;&gt;mediaUrls&lt;/font&gt;: &lt;font color=&quot;#800080&gt;[String]&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="800" y="720" width="280" height="200" as="geometry" />
        </mxCell>
        <mxCell id="shopping_carts_Collection" value="&lt;b&gt;shopping_carts&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&gt;ObjectID&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;userId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: users, unique, optional for guest carts)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#800080&quot;&gt;items&lt;/font&gt;: &lt;font color=&quot;#800080&gt;[{productId, quantity, unitPrice, addedDate}]&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;lastUpdated&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date&lt;/font&gt;&lt;br&gt;isGuestCart: Boolean&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;appliedVoucherCode&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;String &lt;i&gt;(ref: promotions/vouchers)&lt;/i&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8CECC;strokeColor=#B85450;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="800" y="940" width="300" height="190" as="geometry" />
        </mxCell>
        <mxCell id="notifications_Collection" value="&lt;b&gt;notifications&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;userId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: users, optional for global notifications)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;type: String &lt;i&gt;(&quot;order_update&quot;, &quot;promotion&quot;, &quot;system&quot; etc.)&lt;/i&gt;&lt;br&gt;content: String &lt;i&gt;(required)&lt;/i&gt;&lt;br&gt;isRead: Boolean &lt;i&gt;(default: false)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;sentAt&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF00FF&quot;&gt;relatedEntity&lt;/font&gt;: &lt;font color=&quot;#FF00FF&quot;&gt;{id: ObjectID, collection: String} &lt;i&gt;(optional)&lt;/i&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=#D6B656;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="1120" y="380" width="280" height="190" as="geometry" />
        </mxCell>
        <mxCell id="blog_posts_Collection" value="&lt;b&gt;blog_posts&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;title: String &lt;i&gt;(unique, required)&lt;/i&gt;&lt;br&gt;content: String &lt;i&gt;(rich text)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;authorId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: users, for admin/manager users)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;publishDate&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date&lt;/font&gt;&lt;br&gt;status: String &lt;i&gt;(&quot;draft&quot;, &quot;published&quot;)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#800080&quot;&gt;tags&lt;/font&gt;: &lt;font color=&quot;#800080&gt;[String]&lt;/font&gt;&lt;br&gt;slug: String &lt;i&gt;(for SEO)&lt;/i&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="1120" y="610" width="280" height="190" as="geometry" />
        </mxCell>
        <mxCell id="feedback_Collection" value="&lt;b&gt;feedback&lt;/b&gt; (Collection)&lt;hr&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;font color=&quot;#FF8000&quot;&gt;_id&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;ObjectID&lt;/font&gt;&lt;br&gt;&lt;font color=&quot;#008000&quot;&gt;userId&lt;/font&gt;: &lt;font color=&quot;#008000&quot;&gt;ObjectID &lt;i&gt;(ref: users, optional)&lt;/i&gt;&lt;/font&gt;&lt;br&gt;name: String &lt;i&gt;(if not logged in)&lt;/i&gt;&lt;br&gt;email: String &lt;i&gt;(if not logged in)&lt;/i&gt;&lt;br&gt;subject: String&lt;br&gt;message: String &lt;i&gt;(required)&lt;/i&gt;&lt;br&gt;&lt;font color=&quot;#FF8000&quot;&gt;submittedAt&lt;/font&gt;: &lt;font color=&quot;#FF8000&quot;&gt;Date&lt;/font&gt;&lt;br&gt;status: String &lt;i&gt;(&quot;new&quot;, &quot;in_progress&quot;, &quot;resolved&quot;)&lt;/i&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=#D6B656;fontFamily=Helvetica;fontSize=12;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="1120" y="830" width="280" height="190" as="geometry" />
        </mxCell>
        <mxCell id="products_categories_Ref" value="&lt;b&gt;belongs to 1 category&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#008000;" parent="1" source="products_Collection" target="product_categories_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="750" y="180" as="sourcePoint" />
            <mxPoint x="800" y="180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="orders_users_customer_Ref" value="&lt;b&gt;placed by 1 user (customer)&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#6C8EBF;" parent="1" source="orders_Collection" target="users_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="250" y="400" as="sourcePoint" />
            <mxPoint x="250" y="370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="orders_promotions_Ref" value="&lt;b&gt;applies 1 promotion&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#6C8EBF;" parent="1" source="orders_Collection" target="promotions_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="450" y="520" as="sourcePoint" />
            <mxPoint x="450" y="520" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="orders_vouchers_Ref" value="&lt;b&gt;uses 1 voucher&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#B85450;" parent="1" source="orders_Collection" target="vouchers_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="450" y="750" as="sourcePoint" />
            <mxPoint x="450" y="750" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="orders_payment_transactions_Ref" value="&lt;b&gt;has 1+ transactions&lt;/b&gt;" style="startArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#6C8EBF;" parent="1" source="orders_Collection" target="payment_transactions_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="250" y="800" as="sourcePoint" />
            <mxPoint x="250" y="830" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="orders_users_delivery_Ref" value="&lt;b&gt;delivered by 1 staff&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#6C8EBF;" parent="1" source="orders_Collection" target="users_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="400" y="650" as="sourcePoint" />
            <mxPoint x="380" y="270" as="targetPoint" />
            <Array as="points">
              <mxPoint x="400" y="350" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="recipes_ingredients_Ref" value="&lt;b&gt;requires many ingredients&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#82B366;" parent="1" source="recipes_Collection" target="ingredients_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="940" y="480" as="sourcePoint" />
            <mxPoint x="940" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="recipes_users_baker_Ref" value="&lt;b&gt;created by 1 baker&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#82B366;" parent="1" source="recipes_Collection" target="users_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="800" y="520" as="sourcePoint" />
            <mxPoint x="400" y="270" as="targetPoint" />
            <Array as="points">
              <mxPoint x="800" y="360" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vouchers_promotions_Ref" value="&lt;b&gt;based on 1 promotion&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#B85450;" parent="1" source="vouchers_Collection" target="promotions_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="590" y="700" as="sourcePoint" />
            <mxPoint x="590" y="650" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vouchers_users_Ref" value="&lt;b&gt;issued to 1 user&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#B85450;" parent="1" source="vouchers_Collection" target="users_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="450" y="700" as="sourcePoint" />
            <mxPoint x="400" y="300" as="targetPoint" />
            <Array as="points">
              <mxPoint x="450" y="320" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="wishlists_users_Ref" value="&lt;b&gt;belongs to 1 user&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#6C8EBF;" parent="1" source="wishlists_Collection" target="users_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="450" y="930" as="sourcePoint" />
            <mxPoint x="400" y="300" as="targetPoint" />
            <Array as="points">
              <mxPoint x="450" y="800" />
              <mxPoint x="100" y="800" />
              <mxPoint x="100" y="300" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="wishlists_products_Ref" value="&lt;b&gt;contains many products&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#6C8EBF;" parent="1" source="wishlists_Collection" target="products_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="730" y="990" as="sourcePoint" />
            <mxPoint x="750" y="200" as="targetPoint" />
            <Array as="points">
              <mxPoint x="750" y="990" />
              <mxPoint x="750" y="300" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="product_reviews_products_Ref" value="&lt;b&gt;reviews 1 product&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#82B366;" parent="1" source="product_reviews_Collection" target="products_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="800" y="720" as="sourcePoint" />
            <mxPoint x="750" y="200" as="targetPoint" />
            <Array as="points">
              <mxPoint x="750" y="720" />
              <mxPoint x="750" y="300" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="product_reviews_users_Ref" value="&lt;b&gt;written by 1 user&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#82B366;" parent="1" source="product_reviews_Collection" target="users_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="800" y="720" as="sourcePoint" />
            <mxPoint x="400" y="300" as="targetPoint" />
            <Array as="points">
              <mxPoint x="800" y="360" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="shopping_carts_users_Ref" value="&lt;b&gt;belongs to 1 user&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#B85450;" parent="1" source="shopping_carts_Collection" target="users_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="800" y="940" as="sourcePoint" />
            <mxPoint x="400" y="300" as="targetPoint" />
            <Array as="points">
              <mxPoint x="800" y="360" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="shopping_carts_products_Ref" value="&lt;b&gt;contains many products&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#B85450;" parent="1" source="shopping_carts_Collection" target="products_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="1100" y="1030" as="sourcePoint" />
            <mxPoint x="750" y="200" as="targetPoint" />
            <Array as="points">
              <mxPoint x="750" y="1030" />
              <mxPoint x="750" y="300" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="notifications_users_Ref" value="&lt;b&gt;sent to 1 user&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#D6B656;" parent="1" source="notifications_Collection" target="users_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="1120" y="380" as="sourcePoint" />
            <mxPoint x="400" y="300" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1120" y="360" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="blog_posts_users_Ref" value="&lt;b&gt;authored by 1 user&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#82B366;" parent="1" source="blog_posts_Collection" target="users_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="1120" y="610" as="sourcePoint" />
            <mxPoint x="400" y="300" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1120" y="360" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="feedback_users_Ref" value="&lt;b&gt;submitted by 1 user&lt;/b&gt;" style="endArrow=open;html=1;fontFamily=Helvetica;fontSize=12;verticalAlign=bottom;labelBackgroundColor=none;strokeColor=#D6B656;" parent="1" source="feedback_Collection" target="users_Collection" edge="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="1120" y="830" as="sourcePoint" />
            <mxPoint x="400" y="300" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1120" y="360" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Legend_Title" value="&lt;b&gt;MongoDB CDM Legend&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontFamily=Helvetica;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="1150" y="50" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Legend_Items" value="&lt;div style=&quot;text-align: left&quot;&gt;&lt;b&gt;Collection&lt;/b&gt;: &lt;font color=&quot;#FFD966&quot;&gt;Yellow Box&lt;/font&gt;&lt;br&gt;&lt;b&gt;_id / ObjectID&lt;/b&gt;: &lt;font color=&quot;#FF8000&gt;Orange Text&lt;/font&gt;&lt;br&gt;&lt;b&gt;Date Type&lt;/b&gt;: &lt;font color=&quot;#FF8000&gt;Orange Text&lt;/font&gt;&lt;br&gt;&lt;b&gt;Reference (Foreign Key - FK)&lt;/b&gt;: &lt;font color=&quot;#008000&gt;Green Text&lt;/font&gt;&lt;br&gt;&lt;b&gt;Embedded Document&lt;/b&gt;: &lt;font color=&quot;#FF00FF&quot;&gt;Pink Text&lt;/font&gt;&lt;br&gt;&lt;b&gt;Array Type&lt;/b&gt;: &lt;font color=&quot;#800080&quot;&gt;Purple Text&lt;/font&gt;&lt;br&gt;&lt;b&gt;Other Fields&lt;/b&gt;: Black Text&lt;br&gt;&lt;br&gt;&lt;b&gt;Relationships:&lt;/b&gt;&lt;br&gt;- &lt;b&gt;Line with open arrow:&lt;/b&gt; Reference (1-N or N-1)&lt;br&gt;  &lt;i&gt;(Arrow points to the &quot;1&quot; side)&lt;/i&gt;&lt;br&gt;- &lt;b&gt;Nested fields:&lt;/b&gt; Embedding (1-1 or 1-N where N is small)&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontFamily=Helvetica;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="1150" y="90" width="270" height="230" as="geometry" />
        </mxCell>
        <mxCell id="MongoDB_Design_Notes" value="&lt;b&gt;Key MongoDB Design Principles:&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;1. Data Embedding (Denormalization):&lt;/b&gt;&lt;br&gt;   - Data that is frequently accessed together is embedded within a single document.&lt;br&gt;   - Example: &lt;i&gt;orderDetails&lt;/i&gt; in &lt;b&gt;orders&lt;/b&gt;; &lt;i&gt;customerInfo&lt;/i&gt; in &lt;b&gt;users&lt;/b&gt;; &lt;i&gt;requiredIngredients&lt;/i&gt; in &lt;b&gt;recipes&lt;/b&gt;.&lt;br&gt;   - Benefits: Reduces number of queries, improves read performance, ACID-like transactions on single documents.&lt;br&gt;&lt;br&gt;&lt;b&gt;2. Data Referencing (Normalization):&lt;/b&gt;&lt;br&gt;   - Used when data is large, changes frequently, or needs to be accessed independently.&lt;br&gt;   - Example: &lt;b&gt;orders&lt;/b&gt; references &lt;b&gt;users&lt;/b&gt;; &lt;b&gt;products&lt;/b&gt; references &lt;b&gt;product_categories&lt;/b&gt;.&lt;br&gt;   - Benefits: Reduces data duplication, improves write performance, flexible relationships.&lt;br&gt;&lt;br&gt;&lt;b&gt;3. Denormalization for Read Optimization:&lt;/b&gt;&lt;br&gt;   - Duplicating commonly accessed fields to avoid lookups (e.g., &lt;i&gt;productName, unitPrice&lt;/i&gt; in &lt;i&gt;orderDetails&lt;/i&gt;).&lt;br&gt;   - &lt;i&gt;averageRating, totalReviews&lt;/i&gt; in &lt;b&gt;products&lt;/b&gt; for quick display.&lt;br&gt;&lt;br&gt;&lt;b&gt;4. Arrays for Lists:&lt;/b&gt;&lt;br&gt;   - Store lists of simple values or embedded sub-documents (e.g., &lt;i&gt;roles&lt;/i&gt; in &lt;b&gt;users&lt;/b&gt;, &lt;i&gt;imageUrl&lt;/i&gt; in &lt;b&gt;products&lt;/b&gt;).&lt;br&gt;&lt;br&gt;&lt;b&gt;5. Flexible Schema:&lt;/b&gt;&lt;br&gt;   - Allows adding/removing fields without strict schema migrations. E.g., &lt;i&gt;customerInfo&lt;/i&gt; only exists for users with &quot;customer&quot; role.&lt;br&gt;" style="note;whiteSpace=wrap;html=1;backgroundOutline=1;fillColor=#DAE8FC;strokeColor=#6C8EBF;fontFamily=Helvetica;fontSize=12;align=left;" parent="1" vertex="1">
          <mxGeometry x="1420" y="50" width="350" height="400" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
